package business_DS_Project;

import java.time.LocalDate;
import java.util.Scanner;


public class Store {
	
	private static LinkedList<Customer> customers_list;
	private static LinkedList<Order> orders_list;
	private static LinkedList<Product> products_list;
	private static LinkedList<Review> reviews_list;
	
	private static Reviews all_Reviews;
	private static Customers all_Customers;
	private static Orders all_Orders;
	private static Products all_Products;
	
	public Store() {
		
		customers_list= new LinkedList<Customer>();
		orders_list= new LinkedList<Order>();
		products_list= new LinkedList<Product>();
		reviews_list= new LinkedList<Review>();
		
		
		all_Products= new Products(products_list);
		all_Reviews= new Reviews(reviews_list,products_list,customers_list);
		all_Customers= new Customers(customers_list);
		all_Orders=new Orders(customers_list,orders_list);	
	}

	
	public static void Load_all() {
		all_Products.load_products("C:\\Users\\win\\Documents\\NetBeansProjects\\212project2025\\products.csv");
	    all_Customers.loadCustomers("C:\\Users\\win\\Documents\\NetBeansProjects\\212project2025\\customers.csv");
	    all_Orders.loadOrders("C:\\Users\\win\\Documents\\NetBeansProjects\\212project2025\\Orders.csv");
	    all_Reviews.load_revews("C:\\Users\\win\\Documents\\NetBeansProjects\\212project2025\\reviews.csv");
	}

	public static void add_Customer(Customer c) {
	    if (all_Customers != null)
	        all_Customers.addCustomer(c);
	    else
	        System.out.println("⚠️ Error: Customer list not initialized!");
	}

	public static void add_Product(Product p) {
	    if (all_Products != null)
	    	all_Products.addProduct(p);
	    else
	        System.out.println(" Error: Product list not initialized!");
	}

	public static void add_Order(Order o) {
	    if (all_Orders != null)
	        all_Orders.addOrder(o);
	    else
	        System.out.println("Error: Orders list not initialized!");
	}

	public static void add_Review(Review r) {
	    all_Reviews.addReview(r);
	}

	public void displayTop3Products() {
	    if (products_list.empty()) {
	        System.out.println("No products available.");
	        return;
	    }

	    LinkedList<Product> tempList = new LinkedList<>();
	    products_list.findFirst();
	    int count = 0; 
	    while (true) {
	        tempList.addLast(products_list.retrieve());
	        count++;
	        if (products_list.last()) break;
	        products_list.findNext();
	    }
	    LinkedList<Product> topList = new LinkedList<>();
	    int needed = Math.min(3, count);
	    for (int k = 0; k < needed; k++) {
	        if (tempList.empty()) break;
	        tempList.findFirst();
	        Product maxProd = tempList.retrieve();
	        while (true) {
	            Product cur = tempList.retrieve();
	            if (cur.getAverageRating() > maxProd.getAverageRating()) {
	                maxProd = cur;
	            }
	            if (tempList.last()) break;
	            tempList.findNext();
	        }

	        tempList.findFirst();
	        while (true) {
	            if (tempList.retrieve() == maxProd) {
	                tempList.remove();
	                break;
	            }
	            if (tempList.last()) break;
	            tempList.findNext();
	        }

	        topList.addLast(maxProd);
	    }
	}
	


	
	public void showCommonHighRatedProducts2(int c1, int c2) {
		LinkedList<Product> allProducts= all_Products.get_Products();
		if(allProducts.empty()) {
			System.out.println("NO PRODUCTS FOUND!");
			return;
		}
		System.out.println("===COMMON HIGH RATED PRODUTS (>4)=====");
		
		boolean anyfound=false;
		allProducts.findFirst();
		while(true) {
			Product p= allProducts.retrieve();
			int pid= p.getProductId();
			
			if(p.getAverageRating()>4) {
				boolean found1=false;
				boolean found2=false;
				
				if(!reviews_list.empty()) {
					reviews_list.findFirst();
					while(true){
						Review r= reviews_list.retrieve();
						
						if(r.getProductId()==pid) {
							if(r.getCustomerId()==c1)found1=true;
							if(r.getCustomerId()==c2)found2=true;			
						}
						
						if(reviews_list.last())break;
						reviews_list.findNext();
					}
				}
				
				if(found1&&found2) {}
				System.out.println("PRODUCT: "+p.getName()+
						"| ID: "+pid+
						"| AVERAGE RATING: "+p.getAverageRating());
				anyfound=true;

			}
		}
		if(!anyfound)
			System.out.println(" NO COMMON HIGH-RATED PRODUCTS FOUND");
		
	}

	public static void main(String[] args) {
		
		
		

	}

}
